using Distributions
using UUIDs
using LinearAlgebra
using StatsBase
using Statistics, StatsPlots
using JLD2 # for storing and loading data
using Plots

include("types.jl")
include("backgroundFunctions.jl") 
EVals = [-0.36580460304497125 + 0.0im, -0.22430438454292942 - 0.6930017891501842im, -0.22430438454292942 + 0.6930017891501842im]

EVecs = [0.5168916510919502 + 0.0im 0.3509270876846652 + 0.0im -0.04516491234583243 - 0.4796611825850426im -0.04516491234583243 + 0.4796611825850426im; -0.7700444556026412 + 0.0im -0.8279953988073304 + 0.0im 0.7770621207941376 - 0.0im 0.7770621207941376 + 0.0im; 0.288954449445293 + 0.0im 0.4367232803416252 + 0.0im 0.10701430913994639 + 0.3681449461368627im 0.10701430913994639 - 0.3681449461368627im; 0.2374023664010888 + 0.0im -0.02337894545738763 + 0.0im 0.055799379980743975 + 0.11816685875396711im 0.055799379980743975 - 0.11816685875396711im]
EVecsT = [-0.13515175622515632 + 0.0im -0.14634175765893348 + 0.0im 0.5841773629950274 - 0.0im 0.5841773629950274 + 0.0im; 0.04345086246258555 + 0.0im -0.00627378200994623 + 0.0im 0.32550336935298163 - 0.26795548195975766im 0.32550336935298163 + 0.26795548195975766im; 0.13851116567160893 + 0.0im -0.47005108539214535 + 0.0im 0.1278202110625935 - 0.5206289726891263im 0.1278202110625935 + 0.5206289726891263im; -0.980132992162189 + 0.0im 0.8704003140775236 + 0.0im -0.3716835551895628 - 0.2354634282303146im -0.3716835551895628 + 0.2354634282303146im]
EVecsT, EVecs = biorthonormalize!(EVecsT, EVecs)
print(abs.(EVecsT' * EVecs))
# print(" shall be 1: $(dot(EVecsT[:, 1], EVecs[:, 1]))  $(EVecsT[:, 1]' * EVecs[:, 1])\n")
# print(" shall be 0: $(EVecsT[:, 2]' * EVecs[:, 1])\n")
# print(eigenvalues_are_distinct(length(EVals), EVals))
# print(EVals[2]-EVals[3])